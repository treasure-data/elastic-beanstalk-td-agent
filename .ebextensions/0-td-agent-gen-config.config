files:
  "/etc/td-agent/td-agent.conf":
    owner: root
    group: root
    content: |
      ####
      ## Output descriptions:
      ##

      # Treasure Data (http://www.treasure-data.com/) provides cloud based data
      # analytics platform, which easily stores and processes data from td-agent.
      # FREE plan is also provided.
      # @see http://docs.fluentd.org/articles/http-to-td
      #
      # This section matches events whose tag is td.DATABASE.TABLE
      <match td.*.*>
        type tdlog
        apikey YOUR_API_KEY_IS_HERE
      
        auto_create_table
        buffer_type file
        buffer_path /var/log/td-agent/buffer/td
      </match>
      
      ## match tag=debug.** and dump to console
      <match debug.**>
        type stdout
      </match>
      
      ####
      ## Source descriptions:
      ##

      ## built-in TCP input
      ## @see http://docs.fluentd.org/articles/in_forward
      <source>
        type forward
      </source>

      # HTTP input
      # POST http://localhost:8888/<tag>?json=<json>
      # POST http://localhost:8888/td.myapp.login?json={"user"%3A"me"}
      # @see http://docs.fluentd.org/articles/in_http
      <source>
        type http
        port 8888
      </source>
      
      ## live debugging agent
      <source>
        type debug_agent
        bind 127.0.0.1
        port 24230
      </source>
